# Overview
CryptoSmartTrader V2 is an institutional-grade, multi-agent cryptocurrency trading intelligence system. Its primary purpose is to generate substantial financial returns through enhanced alpha generation, robust portfolio construction, and comprehensive risk management. Key capabilities include an Enhanced Alpha Motor with four signal buckets (momentum, mean-revert, funding, sentiment), Kelly sizing with volatility targeting, and an enterprise dashboard interface. The system is designed for Windows workstation deployment and aims to successfully generate real-time trading positions with high portfolio allocation and strong average alpha scoring.

# User Preferences
Preferred communication style: Simple, everyday language.
Data integrity policy: ABSOLUTE ZERO-TOLERANCE for synthetic/fallback data - Complete elimination of all non-authentic data sources in production mode. Only 100% authentic data from direct exchange APIs allowed. Production automatically blocks any violations. No fallback, no synthetic data, no interpolated values, no NaN values allowed in production. Strict data integrity enforcement with real-time validation and automatic production blocking.
AI/LLM Governance: ENTERPRISE-GRADE AI GOVERNED VOLLEDIG GEÏMPLEMENTEERD - Complete replacement van experimentele AI implementations met production-ready enterprise framework (src/cryptosmarttrader/ai/): (1) EnterpriseAIGovernance met multi-tier rate limiting (EnterpriseRateLimiter), advanced circuit breakers met exponential backoff, real-time cost control (AICostController), comprehensive output validation (AIOutputValidator), en sophisticated fallback engine, (2) EnterpriseAIEvaluator met real-time response quality analysis, automated A/B testing capability, SLO monitoring/violations tracking, model performance snapshots, en comprehensive evaluation metrics, (3) ModernizedOpenAIAdapter replacing legacy experimental implementations met structured result schemas (NewsAnalysisResult, SentimentAnalysisResult), full governance integration, en enterprise error handling, (4) AIFeatureFlagManager met granular feature state management (disabled/development/testing/canary/production/emergency_disabled), sophisticated rollout strategies (immediate/gradual/percentage/segment/time-based), real-time metrics tracking, emergency disable capabilities, en comprehensive feature lifecycle management. ALL experimental AI code geïdentificeerd en vervangen door production-ready implementations met harde guardrails: rate limits, cost controls, circuit breakers, output validation, fallback strategies, evaluation metrics, feature flags, en comprehensive monitoring. ZERO experimentele AI dependencies, ZERO unbound imports, ZERO missing guardrails.
Analysis Framework Consolidation: ENTERPRISE ANALYSIS FRAMEWORKS VOLLEDIG GEÏMPLEMENTEERD - Complete replacement van scattered TA/sentiment implementations met unified enterprise frameworks (src/cryptosmarttrader/analysis/): (1) EnterpriseTechnicalAnalyzer met standardized IndicatorResult format, robust data validation, configurable quality thresholds, performance monitoring, en caching voor RSI/MACD/Bollinger Bands indicators, (2) EnterpriseSentimentAnalyzer met multi-source analysis (crypto-specific lexicon met 200+ terms, rule-based pattern matching, LLM integration), uncertainty quantification, emotion/risk indicator detection, en comprehensive result aggregation, (3) Comprehensive migration van 167 TA files en 256 sentiment files naar unified frameworks, (4) Backward compatibility aliases voor legacy code, automated migration script, complete backup system. ALL scattered implementations geconsolideerd: consistent error handling, uniform validation, enterprise-grade robustness, comprehensive monitoring metrics. ZERO scattered TA/sentiment code, ZERO inconsistent implementations, ZERO missing error handling.
Social Media Data Ingestion: ENTERPRISE SOCIAL MEDIA FRAMEWORK VOLLEDIG GEÏMPLEMENTEERD - TOS-compliant social media data collection met comprehensive ban protection (src/cryptosmarttrader/data/): (1) EnterpriseSocialMediaManager met unified data collection voor Reddit/Twitter/Telegram/Discord, (2) TOSComplianceValidator met platform-specific rule enforcement (rate limiting, authentication, endpoint restrictions, header requirements), (3) BanProtection system met adaptive backoff strategies, ban detection patterns, exponential backoff met jitter, (4) Comprehensive TOS rules database voor major platforms met commercial use policies, data retention limits, forbidden endpoints, (5) SocialMediaSecretsManager met secure credential management, setup instructions, validation tools, (6) Standardized SocialMediaPost format met crypto keyword extraction, sentiment indicators, engagement metrics, quality levels. ALL social media scraping nou TOS-compliant: mandatory authentication, rate limit enforcement, ban detection, forbidden endpoint blocking, comprehensive audit trails. ZERO TOS violations, ZERO unprotected scraping, ZERO missing compliance controls.
Data ingestion robustness: ENTERPRISE-GRADE HARDENED DATA LAYER VOLLEDIG GEÏMPLEMENTEERD - Complete enterprise data layer hardening (src/cryptosmarttrader/infrastructure/) met: (1) HardenedHTTPClient met strikte timeout discipline (10-30s), exponential backoff + jitter, max retries, per-source circuit breakers (CLOSED/OPEN/HALF_OPEN states), intelligent rate limiting (sliding window algorithm), connection pooling, comprehensive metrics tracking, (2) DataOrchestrator met APScheduler-based centrale scheduling, per-source rate limits, health monitoring (HEALTHY/DEGRADED/CRITICAL/OFFLINE), job management, execution history tracking, dependency management, graceful shutdown, (3) Circuit breaker protection met automatic recovery, (4) Rate limiting met per-source enforcement (60 req/min default), (5) Real-time health monitoring met degradation detection, (6) Exponential backoff algorithm met jitter (1s-60s range). ZERO single points of failure, ALL HTTP requests hardened met enterprise-grade robustness, comprehensive error handling, centralized orchestration.

# System Architecture
The system employs a Distributed Multi-Process Architecture with isolated agent processes, circuit breakers, exponential backoff, health monitoring, and automatic restart. It features an Enhanced Alpha Motor with comprehensive coin selection logic and is designed for Windows workstation deployment via .bat scripts.

## Core Architectural Decisions
*   **Deployment & Structure:** Multi-service `src/` structure with semantic versioning, automated CI/CD using Docker, and strict guardrails via CentralRiskGuard.
*   **Foundational Services:** Comprehensive testing (unit, integration, E2E), enterprise security (secrets management, log sanitization), production-grade structured JSON logging, Pydantic configuration, async I/O with global rate limiting, intelligent caching, and health monitoring. Centralized observability and alerts are fully implemented, providing metrics collection, critical alerts for trading errors/drawdowns/signal loss, and Prometheus integration.
*   **Data & Exchange Management:** Multi-exchange integration with a real-time data pipeline, strict data integrity filters, timestamp synchronization, and TOS-compliant social media data collection with ban protection.
*   **UI/UX:** An enterprise Streamlit dashboard featuring performance optimization, async data refresh, intelligent caching, modular page architecture, and session state management.
*   **Machine Learning & AI:** Enterprise ML governance infrastructure is fully implemented, including a ModelRegistry with versioning, performance tracking, drift detection, and artifact storage. It also incorporates a CanaryDeploymentOrchestrator for phased deployments, DatasetVersion management with quality assessment, and drift status monitoring with automatic model rollback triggers.
*   **Ensemble & Meta-Learning:** Utilizes an alpha-stacking architecture combining orthogonal information sources (TA, Sentiment, Regime), a meta-learner, sophisticated feature engineering, time series cross-validation, and consensus mechanisms with dynamic model weights and regime-adaptive strategies.
*   **Trading & Risk Management:** Enterprise Risk Management & Execution Policy are fully implemented, featuring a CentralizedRiskGuard with multi-tier kill-switch states, daily loss limits, max drawdown protection, exposure limits, and data gap detection. An ExecutionPolicy enforces comprehensive gates (spread/depth/volume/volatility) and tracks slippage.
*   **Execution & Alpha Preservation:** Features a comprehensive liquidity gating system, real-time spread monitoring, slippage tracking, an integrated execution filter with idempotent order IDs, market microstructure analysis, and support for advanced order types (TWAP, Iceberg).
*   **Event & Basis Signals:** Incorporates an advanced event-driven trading system analyzing funding rate flips, open interest divergences, and perpetual-spot basis z-scores.
*   **Backtest-Live Parity System:** Provides advanced execution simulation including latency modeling, market microstructure simulation, comprehensive fee structures, and daily parity reporting with drift detection.
*   **Hyperparameter Tuning & OOS Validation:** Uses an advanced optimization system with Bayesian optimization and robust out-of-sample validation, featuring walk-forward and regime-aware cross-validation.
*   **Return Attribution Dashboard:** Offers an advanced PnL decomposition system splitting returns into alpha, fees, slippage, timing, and sizing components, alongside real-time performance monitoring.
*   **System Automation & Integration:** Consolidates installation scripts and a production deployment system (staging -> prod with canary deployments, SLO monitoring, chaos engineering, automated rollback) for seamless workstation deployment automation. All core components are strictly integrated via a DataFlowOrchestrator and IntegratedTradingEngine with a zero-tolerance data policy.

## Technology Stack
*   **Frontend:** Streamlit
*   **Backend:** Python, FastAPI
*   **Machine Learning:** PyTorch, scikit-learn, XGBoost, LightGBM
*   **Data Processing:** pandas, numpy, CuPy, Numba
*   **Exchange Integration:** CCXT
*   **Visualization:** Plotly
*   **Storage:** Local file system (JSON/CSV) with caching

# External Dependencies
*   **AI/ML Services:** OpenAI API
*   **Cryptocurrency Exchanges:** Kraken
*   **Monitoring:** Prometheus
*   **Database:** PostgreSQL
*   **In-memory Data Store:** Redis
*   **Alerting:** AlertManager
*   **Visualization:** Grafana