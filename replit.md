# Overview
CryptoSmartTrader V2 is an institutional-grade, multi-agent cryptocurrency trading intelligence system designed to generate substantial financial returns. It achieves this through quantitative strategies, real-time market analysis, deep learning, sentiment analysis, and technical analysis. The project aims to be a leader in algorithmic crypto trading, providing advanced market insights and robust execution capabilities.

# User Preferences
Preferred communication style: Simple, everyday language.
Data integrity policy: ABSOLUTE ZERO-TOLERANCE for synthetic/fallback data - Complete elimination of all non-authentic data sources in production mode. Only 100% authentic data from direct exchange APIs allowed. Production automatically blocks any violations. No fallback, no synthetic data, no interpolated values, no NaN values allowed in production. Strict data integrity enforcement with real-time validation and automatic production blocking.
AI/LLM Governance: ENTERPRISE-GRADE AI GOVERNED VOLLEDIG GEÏMPLEMENTEERD - Complete replacement van experimentele AI implementations met production-ready enterprise framework (src/cryptosmarttrader/ai/): (1) EnterpriseAIGovernance met multi-tier rate limiting (EnterpriseRateLimiter), advanced circuit breakers met exponential backoff, real-time cost control (AICostController), comprehensive output validation (AIOutputValidator), en sophisticated fallback engine, (2) EnterpriseAIEvaluator met real-time response quality analysis, automated A/B testing capability, SLO monitoring/violations tracking, model performance snapshots, en comprehensive evaluation metrics, (3) ModernizedOpenAIAdapter replacing legacy experimental implementations met structured result schemas (NewsAnalysisResult, SentimentAnalysisResult), full governance integration, en enterprise error handling, (4) AIFeatureFlagManager met granular feature state management (disabled/development/testing/canary/production/emergency_disabled), sophisticated rollout strategies (immediate/gradual/percentage/segment/time-based), real-time metrics tracking, emergency disable capabilities, en comprehensive feature lifecycle management. ALL experimental AI code geïdentificeerd en vervangen door production-ready implementations met harde guardrails: rate limits, cost controls, circuit breakers, output validation, fallback strategies, evaluation metrics, feature flags, en comprehensive monitoring. ZERO experimentele AI dependencies, ZERO unbound imports, ZERO missing guardrails.
Analysis Framework Consolidation: ENTERPRISE ANALYSIS FRAMEWORKS VOLLEDIG GEÏMPLEMENTEERD - Complete replacement van scattered TA/sentiment implementations met unified enterprise frameworks (src/cryptosmarttrader/analysis/): (1) EnterpriseTechnicalAnalyzer met standardized IndicatorResult format, robust data validation, configurable quality thresholds, performance monitoring, en caching voor RSI/MACD/Bollinger Bands indicators, (2) EnterpriseSentimentAnalyzer met multi-source analysis (crypto-specific lexicon met 200+ terms, rule-based pattern matching, LLM integration), uncertainty quantification, emotion/risk indicator detection, en comprehensive result aggregation, (3) Comprehensive migration van 167 TA files en 256 sentiment files naar unified frameworks, (4) Backward compatibility aliases voor legacy code, automated migration script, complete backup system. ALL scattered implementations geconsolideerd: consistent error handling, uniform validation, enterprise-grade robustness, comprehensive monitoring metrics. ZERO scattered TA/sentiment code, ZERO inconsistent implementations, ZERO missing error handling.
Social Media Data Ingestion: ENTERPRISE SOCIAL MEDIA FRAMEWORK VOLLEDIG GEÏMPLEMENTEERD - TOS-compliant social media data collection met comprehensive ban protection (src/cryptosmarttrader/data/): (1) EnterpriseSocialMediaManager met unified data collection voor Reddit/Twitter/Telegram/Discord, (2) TOSComplianceValidator met platform-specific rule enforcement (rate limiting, authentication, endpoint restrictions, header requirements), (3) BanProtection system met adaptive backoff strategies, ban detection patterns, exponential backoff met jitter, (4) Comprehensive TOS rules database voor major platforms met commercial use policies, data retention limits, forbidden endpoints, (5) SocialMediaSecretsManager met secure credential management, setup instructions, validation tools, (6) Standardized SocialMediaPost format met crypto keyword extraction, sentiment indicators, engagement metrics, quality levels. ALL social media scraping nou TOS-compliant: mandatory authentication, rate limit enforcement, ban detection, forbidden endpoint blocking, comprehensive audit trails. ZERO TOS violations, ZERO unprotected scraping, ZERO missing compliance controls.
Data ingestion robustness: ENTERPRISE-GRADE VOLLEDIG GEÏMPLEMENTEERD - Comprehensive data ingestion framework (src/cryptosmarttrader/data/) met enterprise features: consistent timeouts/retry/exponential backoff (30s-300s), centrale scheduler met cron-based frequencies (5s real-time → daily comprehensive), advanced caching system (Redis + local fallback), sophisticated rate limiting (per-exchange burst support), data quality validator (6 metrics: completeness/accuracy/consistency/timeliness/validity/uniqueness), robust data manager integration layer, comprehensive monitoring/health checks/performance metrics. ALL geïdentificeerde zwaktes geaddresseerd met production-ready robuuste retry mechanisms, centrale coordinator en caching/rate limit monitoring.

# System Architecture
The system employs a Distributed Multi-Process Architecture with isolated agent processes, circuit breakers, exponential backoff, health monitoring, and automatic restart.

## Core Architectural Decisions
*   **Deployment & Structure:** Multi-service `src/` structure with semantic versioning and automated CI/CD using Docker. Production readiness includes strict guardrails via CentralRiskGuard, CI/CD quality gates, reproducible deployment with Docker containers, and a comprehensive test suite.
*   **Foundational Services:** Comprehensive testing (unit, integration, E2E), enterprise security (secrets management, log sanitization, hardened pickle and subprocess usage), production-grade structured JSON logging, Pydantic configuration, async I/O with global rate limiting, intelligent caching, and health monitoring. Enterprise observability via Unified Metrics & Alerting System (`src/cryptosmarttrader/observability/`) with centralized collection of 45+ metrics, real-time alerting with multi-tier severity (INFO→WARNING→CRITICAL→EMERGENCY), automated degradation detection with trend analysis, multi-channel notifications (Slack/Email/PagerDuty), performance baseline tracking, circuit breaker integration, and comprehensive observability dashboard (port 5006). System consolidates previously scattered Prometheus metrics across 22 files into enterprise-grade monitoring infrastructure.
*   **Data & Exchange Management:** Multi-exchange integration with a real-time data pipeline, strict data integrity filters, timestamp synchronization, and temporal validation/feature engineering. TOS-compliant social media data collection is implemented with ban protection.
*   **UI/UX:** An enterprise Streamlit dashboard featuring performance optimization, async data refresh, intelligent caching, modular page architecture, and session state management.
*   **Machine Learning & AI:** An enterprise AI governance framework (`src/cryptosmarttrader/ai/`) with production-ready LLM integration, including multi-tier rate limiting, advanced circuit breakers, real-time cost control, output validation, and fallback strategies. Features GPU optimization, multi-horizon ML, uncertainty quantification, continual learning, automated feature engineering, reinforcement learning, Human-in-the-Loop & explainability, advanced transformers, conformal prediction, probability calibrator, and regime-aware models. Includes a model registry with versioning, automated retraining triggers with canary deployment, and drift detection with rollback automation. An ML ensemble optimizer uses dynamic model weights and regime-adaptive strategies.
*   **Ensemble & Meta-Learning:** Utilizes an alpha-stacking architecture combining orthogonal information sources (TA, Sentiment, Regime), a meta-learner, sophisticated feature engineering, time series cross-validation, probability calibration, alpha blending, signal decay management, and consensus mechanisms with dynamic model weights and regime-adaptive strategies.
*   **Trading & Risk Management:** Implements an 80% confidence gate, shadow trading, advanced execution simulation, enterprise portfolio risk management (hard caps, correlation limits, kill-switch with progressive escalation, daily loss limits, max-drawdown limits, position size controls, order idempotency & deduplication). RiskGuard and ExecutionPolicy systems are fully implemented and hard-wired to prevent bypass, enforcing Mandatory Execution Gateway and Centralized Risk Guard.
*   **Execution & Alpha Preservation:** Features a comprehensive liquidity gating system with spread/depth/volume thresholds, real-time spread monitoring, slippage tracking and budget enforcement, an integrated execution filter with idempotent order IDs, market microstructure analysis, order book depth analysis, and execution quality scoring. Supports advanced order types like TWAP and Iceberg.
*   **Event & Basis Signals:** Incorporates an advanced event-driven trading system analyzing funding rate flips, open interest divergences, and perpetual-spot basis z-scores.
*   **Backtest-Live Parity System:** Provides advanced execution simulation including latency modeling, market microstructure simulation, comprehensive fee structures, and daily parity reporting with <20 bps tracking error targets, with drift detection and component attribution analysis. Includes daily tracking error monitoring and an auto-disable system.
*   **Hyperparameter Tuning & OOS Validation:** Uses an advanced optimization system with Bayesian optimization and robust out-of-sample validation, featuring walk-forward and regime-aware cross-validation.
*   **Return Attribution Dashboard:** Offers an advanced PnL decomposition system splitting returns into alpha, fees, slippage, timing, and sizing components, alongside real-time performance monitoring and degradation detection.
*   **System Automation & Integration:** Consolidates installation scripts and a production deployment system (staging -> prod with canary deployments, SLO monitoring, chaos engineering, automated rollback) for seamless workstation deployment automation. All components (RiskGuard, ExecutionPolicy, Kelly sizing, regime detection) are strictly integrated via a DataFlowOrchestrator and IntegratedTradingEngine with a zero-tolerance data policy.

## Technology Stack
*   **Frontend:** Streamlit.
*   **Backend:** Python, FastAPI.
*   **Machine Learning:** PyTorch, scikit-learn, XGBoost, LightGBM.
*   **Data Processing:** pandas, numpy, CuPy, Numba.
*   **Exchange Integration:** CCXT.
*   **Visualization:** Plotly.
*   **Storage:** Local file system (JSON/CSV) with caching.

# External Dependencies
*   **AI/ML Services:** OpenAI API
*   **Cryptocurrency Exchanges:** Kraken
*   **Monitoring:** Prometheus
*   **Database:** PostgreSQL
*   **In-memory Data Store:** Redis
*   **Alerting:** AlertManager
*   **Visualization:** Grafana